<Window
    x:Class="MyAthenaeio.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:MyAthenaeio"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="myAthenaeio - Book Scanner"
    Width="900"
    Height="600"
    Activated="Window_Activated"
    Closing="Window_Closing"
    Deactivated="Window_Deactivated"
    StateChanged="Window_StateChanged"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <!--  Header  -->
        <Border
            Grid.Row="0"
            Padding="15"
            Background="#2106F3">
            <StackPanel>
                <TextBlock
                    FontSize="24"
                    FontWeight="Bold"
                    Foreground="White"
                    Text="myAthenaeio" />
                <TextBlock
                    FontSize="12"
                    Foreground="White"
                    Opacity="0.9"
                    Text="Book Scanner &amp; Library Manager" />
            </StackPanel>
        </Border>
        <!--  Main Content  -->
        <TabControl Grid.Row="1" Margin="10">
            <TabItem Header="Scanner Test">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <!--  Scanner Input Field  -->
                    <Border
                        Grid.Row="1"
                        Margin="0,0,0,20"
                        Padding="10"
                        BorderBrush="#2196F3"
                        BorderThickness="2"
                        CornerRadius="5">
                        <StackPanel>
                            <TextBlock
                                Margin="0,0,0,5"
                                FontWeight="SemiBold"
                                Text="Scan or Type ISBN:" />
                            <TextBox
                                x:Name="ScannerInputField"
                                Padding="5"
                                FontSize="16"
                                PreviewKeyDown="ScannerInputField_PreviewKeyDown" />
                        </StackPanel>
                    </Border>
                    <!--  Scan Log  -->
                    <GroupBox Grid.Row="2" Header="Scan History">
                        <ListView
                            x:Name="ScanLogList"
                            HorizontalContentAlignment="Stretch"
                            MouseDoubleClick="ScanLogList_MouseDoubleClick"
                            ScrollViewer.CanContentScroll="True"
                            ScrollViewer.ScrollChanged="ScanLogList_ScrollChanged"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="Padding" Value="0" />
                                    <Setter Property="Margin" Value="0" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Padding="10,8"
                                        BorderBrush="#E0E0E0"
                                        BorderThickness="0,0,0,1">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="60" />
                                                <ColumnDefinition Width="80" />
                                                <ColumnDefinition Width="160" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="80" />
                                            </Grid.ColumnDefinitions>
                                            <Border
                                                Grid.Column="0"
                                                Width="50"
                                                Height="75"
                                                VerticalAlignment="Center"
                                                Background="#F5F5F5"
                                                ClipToBounds="True"
                                                CornerRadius="2">
                                                <Image
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Source="{Binding Cover}"
                                                    Stretch="UniformToFill" />
                                            </Border>
                                            <TextBlock
                                                Grid.Column="1"
                                                VerticalAlignment="Center"
                                                Foreground="Gray"
                                                Text="{Binding Timestamp, StringFormat='{}{0:HH:mm:ss}'}" />
                                            <TextBlock
                                                Grid.Column="2"
                                                Margin="10,0"
                                                VerticalAlignment="Center"
                                                FontFamily="Consolas"
                                                FontSize="14"
                                                FontWeight="SemiBold"
                                                Text="{Binding Barcode}" />
                                            <TextBlock
                                                Grid.Column="3"
                                                VerticalAlignment="Center"
                                                Foreground="Gray"
                                                Text="{Binding Title}"
                                                TextTrimming="CharacterEllipsis" />
                                            <TextBlock
                                                Grid.Column="4"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Center"
                                                FontSize="11"
                                                Foreground="Gray"
                                                Text="{Binding Source}" />
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </GroupBox>
                </Grid>
            </TabItem>
            <!--  Settings Tab  -->
            <TabItem Header="⚙️ Settings">
                <ScrollViewer>
                    <StackPanel MaxWidth="600" Margin="20">
                        <GroupBox Padding="15" Header="Scanner Settings">
                            <StackPanel>
                                <CheckBox
                                    x:Name="BackgroundScanningCheckbox"
                                    Margin="0,5"
                                    Checked="BackgroundScanning_Changed"
                                    Content="Enable background scanning"
                                    IsChecked="False"
                                    Unchecked="BackgroundScanning_Changed" />
                                <TextBlock
                                    Margin="25,0,0,15"
                                    FontSize="11"
                                    Foreground="Gray"
                                    Text="Scan books even when app is minimized"
                                    TextWrapping="Wrap" />
                                <TextBlock
                                    Margin="0,10,0,5"
                                    FontWeight="SemiBold"
                                    Text="Current Mode:" />
                                <TextBlock
                                    x:Name="CurrentModeText"
                                    FontSize="14"
                                    Foreground="#2196F3"
                                    Text="Focused Field Only" />
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
        <!--  Status Bar  -->
        <Border
            Grid.Row="2"
            Padding="10,5"
            Background="#F5F5F5"
            BorderBrush="#E0E0E0"
            BorderThickness="0,1,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock
                    x:Name="StatusText"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    Text="Ready to scan" />
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock
                        Margin="0,0,5,0"
                        VerticalAlignment="Center"
                        Text="Total scans: " />
                    <TextBlock
                        x:Name="ScanCountText"
                        VerticalAlignment="Center"
                        FontWeight="Bold"
                        Text="0" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
