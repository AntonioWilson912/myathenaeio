<Window
    x:Class="MyAthenaeio.Views.Authors.AuthorEditDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:MyAthenaeio.Views.Authors"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Author Edit"
    Width="600"
    Height="825"
    WindowStartupLocation="CenterOwner"
    mc:Ignorable="d">
    <Window.Resources>
        <ResourceDictionary Source="/Resources/Styles.xaml" />
    </Window.Resources>
    <Grid Background="{StaticResource DarkAcademiaBackground}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Style="{StaticResource DarkAcademiaBorderStyle}">
            <TextBlock Style="{StaticResource HeaderTextBlockStyle}" Text="Edit Author Information" />
        </Border>

        <ScrollViewer
            Grid.Row="1"
            Margin="15"
            VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <GroupBox Header="Basic Information">
                    <Grid Margin="5">
                        <Grid.Resources>
                            <Style BasedOn="{StaticResource {x:Type Label}}" TargetType="Label">
                                <Setter Property="Margin" Value="0,0,10,10" />
                            </Style>
                            <Style BasedOn="{StaticResource {x:Type TextBox}}" TargetType="TextBox">
                                <Setter Property="Margin" Value="0,0,0,10" />
                            </Style>
                            <Style BasedOn="{StaticResource {x:Type DatePicker}}" TargetType="DatePicker">
                                <Setter Property="Margin" Value="0,0,0,10" />
                            </Style>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Label
                            Grid.Row="0"
                            Grid.Column="0"
                            Content="Name:" />
                        <TextBox
                            x:Name="NameTextBox"
                            Grid.Row="0"
                            Grid.Column="1"
                            Background="{StaticResource DarkAcademiaPanel}"
                            IsReadOnly="True"
                            ToolTip="Author name cannot be changed" />

                        <Label
                            Grid.Row="1"
                            Grid.Column="0"
                            Content="OL Key:" />
                        <Grid Grid.Row="1" Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBox
                                x:Name="OLKeyTextBox"
                                Grid.Column="0"
                                IsReadOnly="{Binding HasOLKey}" />
                            <Button
                                x:Name="FetchOLDataButton"
                                Grid.Column="1"
                                Margin="10,0,0,10"
                                Click="FetchOLData_Click"
                                Content="Fetch Data"
                                Visibility="{Binding CanFetchOLData, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        </Grid>

                        <Label
                            Grid.Row="2"
                            Grid.Column="0"
                            Content="Birth Date:" />
                        <DatePicker
                            x:Name="BirthDatePicker"
                            Grid.Row="2"
                            Grid.Column="1"
                            ToolTip="Format: YYYY-MM-DD or YYYY" />

                        <Label
                            Grid.Row="3"
                            Grid.Column="0"
                            Content="Photo URL:" />
                        <Grid Grid.Row="3" Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBox
                                x:Name="PhotoUrlTextBox"
                                Grid.Column="0"
                                TextChanged="PhotoUrlTextBox_TextChanged" />
                            <Button
                                x:Name="ViewPhotoButton"
                                Grid.Column="1"
                                Margin="10,0,0,10"
                                Click="ViewPhoto_Click"
                                Content="View Photo"
                                IsEnabled="False"
                                ToolTip="View author photo" />
                        </Grid>
                    </Grid>
                </GroupBox>

                <GroupBox Header="Biography">
                    <TextBox
                        x:Name="BioTextBox"
                        Height="200"
                        AcceptsReturn="True"
                        TextWrapping="Wrap"
                        VerticalScrollBarVisibility="Auto" />
                </GroupBox>

                <Border
                    Margin="0,10,0,0"
                    Padding="10"
                    Background="{StaticResource DarkAcademiaPanel}"
                    BorderBrush="{StaticResource DarkAcademiaGold}"
                    BorderThickness="1">
                    <TextBlock TextWrapping="Wrap">
                        <Run FontWeight="Bold">Note:</Run>
                        <LineBreak />
                        <Run>• If the author already has an Open Library key, only the biography can be edited.</Run>
                        <LineBreak />
                        <Run>• To add an OL key, enter it and click "Fetch Data" to validate and retrieve author information.</Run>
                        <LineBreak />
                        <Run>• OL keys look like: OLA12345A (for authors)</Run>
                    </TextBlock>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <StackPanel
            Grid.Row="2"
            Margin="15"
            HorizontalAlignment="Right"
            Orientation="Horizontal">
            <Button
                Width="100"
                Click="Save_Click"
                Content="Save" />
            <Button
                Width="100"
                Click="Cancel_Click"
                Content="Cancel" />
        </StackPanel>
    </Grid>
</Window>